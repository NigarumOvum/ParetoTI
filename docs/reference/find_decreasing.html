<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find features that are decreasing functions of distance from archetype — find_decreasing • ParetoTI</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Find features that are decreasing functions of distance from archetype — find_decreasing" />

<meta property="og:description" content="find_decreasing() Fits gam models to find if features are a decreasing function of distance from archetype. Both gam functions and first derivatives can be visualised using plot() method.
fit_arc_gam_1() Finds single GAM model fit and it's first derivative for a single feature and one or several archetypes.
get_top_decreasing() Get top-12 genes and top-3 gene sets for each archetype." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ParetoTI</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Manual for Pareto front and task inference, ParetoTI R package</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find features that are decreasing functions of distance from archetype</h1>
    
    <div class="hidden name"><code>find_decreasing.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>find_decreasing()</code> Fits gam models to find if features are a decreasing function of distance from archetype. Both gam functions and first derivatives can be visualised using plot() method.</p>
<p><code>fit_arc_gam_1()</code> Finds single GAM model fit and it's first derivative for a single feature and one or several archetypes.</p>
<p><code>get_top_decreasing()</code> Get top-12 genes and top-3 gene sets for each archetype.</p>
    
    </div>

    <pre class="usage"><span class='fu'>find_decreasing</span>(<span class='no'>data_attr</span>, <span class='no'>arc_col</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Gpx1"</span>, <span class='st'>"Alb"</span>, <span class='st'>"Cyp2e1"</span>,
  <span class='st'>"Apoa2"</span>)[<span class='fl'>3</span>], <span class='kw'>min.sp</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>60</span>), <span class='kw'>N_smooths</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>n_points</span> <span class='kw'>=</span> <span class='fl'>200</span>,
  <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='no'>n_points</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>, <span class='kw'>each</span> <span class='kw'>=</span> <span class='no'>n_points</span>), <span class='fu'>rep</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0</span>),
  <span class='kw'>each</span> <span class='kw'>=</span> <span class='no'>n_points</span>/<span class='fl'>2</span>))[<span class='fl'>1</span>], <span class='kw'>return_only_summary</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>stop_at_10</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>one_arc_per_model</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"s"</span>, <span class='st'>"m"</span>,
  <span class='st'>"cmq"</span>)[<span class='fl'>1</span>], <span class='kw'>clust_options</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='no'>...</span>)

<span class='fu'>fit_arc_gam_1</span>(<span class='no'>feature</span>, <span class='no'>col</span>, <span class='no'>N_smooths</span>, <span class='no'>data_attr</span>, <span class='no'>min.sp</span>, <span class='no'>...</span>, <span class='no'>d</span>, <span class='no'>n_points</span>,
  <span class='no'>weights</span>)

<span class='fu'>get_top_decreasing</span>(<span class='no'>summary_genes</span>, <span class='kw'>summary_sets</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>cutoff_genes</span> <span class='kw'>=</span> <span class='fl'>0.99</span>, <span class='kw'>cutoff_sets</span> <span class='kw'>=</span> <span class='fl'>0.99</span>,
  <span class='kw'>cutoff_metric</span> <span class='kw'>=</span> <span class='st'>"mean_prob"</span>, <span class='kw'>gam_fit_pval</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
  <span class='kw'>order_by</span> <span class='kw'>=</span> <span class='st'>"deriv20"</span>, <span class='kw'>order_decreasing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>min_max_ratio_cutoff</span> <span class='kw'>=</span> <span class='fl'>1.3</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data_attr</th>
      <td><p>data.table dim(examples, dimensions) that includes distance of each example to archetype in columns given by <code>arc_col</code> and feature values given by <code>features</code></p></td>
    </tr>
    <tr>
      <th>arc_col</th>
      <td><p>character vector, columns that give distance to archetypes (column per archetype)</p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p>character vector (1L), column than containg feature values</p></td>
    </tr>
    <tr>
      <th>min.sp</th>
      <td><p>lower bound for the smoothing parameter, details: <a href='http://www.rdocumentation.org/packages/mgcv/topics/gam'>gam</a>. Default value of 60 works well to stabilise curve shape near min and max distance</p></td>
    </tr>
    <tr>
      <th>N_smooths</th>
      <td><p>number of bases used to represent the smooth term (<a href='http://www.rdocumentation.org/packages/mgcv/topics/s'>s</a>), 4 for cubic splines</p></td>
    </tr>
    <tr>
      <th>n_points</th>
      <td><p>number of points at which to evaluate derivative</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>numeric vector (1L), finite difference interval</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>how to weight points along x axis when calculating mean (integral) probability. Useful if you care that the function is decreasing near the archetype but not far away. Two defaults suggest to weight point equally or discard bottom 50 percent.</p></td>
    </tr>
    <tr>
      <th>return_only_summary</th>
      <td><p>set to TRUE when using inside other function to fit multiple features</p></td>
    </tr>
    <tr>
      <th>stop_at_10</th>
      <td><p>prevents <code>find_decreasing()</code> from fitting too many features</p></td>
    </tr>
    <tr>
      <th>one_arc_per_model</th>
      <td><p>If TRUE fit separate gam models for each archetype. If FALSE combine all archetypes in one model: feature ~ s(arc1) + s(arc2) + ... + s(arcN).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>one of s, m, cmq. s means single core processing using lapply. m means multi-core parallel procession using parLapply. cmq means multi-node parallel processing on a computing cluster using clustermq package.</p></td>
    </tr>
    <tr>
      <th>clust_options</th>
      <td><p>list of options for parallel processing. The default for "m" is list(cores = parallel::detectCores()-1, cluster_type = "PSOCK"). The default for "cmq" is list(memory = 2000, template = list(), n_jobs = 10, fail_on_error = FALSE). Change these options as required.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to <a href='http://www.rdocumentation.org/packages/mgcv/topics/gam'>gam</a></p></td>
    </tr>
    <tr>
      <th>summary_genes</th>
      <td><p>gam_deriv summary data.table for decreasing genes</p></td>
    </tr>
    <tr>
      <th>summary_sets</th>
      <td><p>gam_deriv summary data.table for decreasing gene sets</p></td>
    </tr>
    <tr>
      <th>cutoff_genes</th>
      <td><p>value of cutoff_metric (lower bound) for genes</p></td>
    </tr>
    <tr>
      <th>cutoff_sets</th>
      <td><p>value of cutoff_metric (lower bound) for gene sets</p></td>
    </tr>
    <tr>
      <th>cutoff_metric</th>
      <td><p>probability metric for selecting decreasing genes: mean_prob, prod_prob, mean_prob_excl or prod_prob_excl</p></td>
    </tr>
    <tr>
      <th>gam_fit_pval</th>
      <td><p>smooth term probability in gam fit (upper bound)</p></td>
    </tr>
    <tr>
      <th>order_by</th>
      <td><p>order decreasing feature list by measure in summary sets. By default is deriv20, the average value of derivative at 20 of point closest to vertex.</p></td>
    </tr>
    <tr>
      <th>min_max_ratio</th>
      <td><p>what should be the ratio of gene expression at the point closest to archetype compared to point furthest from archetype? By default, at least 1.3 or closest point is 30 percent higher than furthest point.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>find_decreasing()</code> list (S3 object, gam_deriv) containing summary p-values for features and each archetype, function call and (optionally) a data.table with values of the first derivative</p>
<p><code>fit_arc_gam_1()</code> list containing function call, 1st derivative values of GAM model (derivs), summary of GAM model (p-value and r^2, gam_sm)</p>
<p><code>get_top_decreasing()</code> return character vector with one element for each archetype and print to output</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Vitalii Kleshchevnikov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

