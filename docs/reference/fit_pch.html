<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find the smallest polytope (Principal Convex Hull) that contains most of the data — fit_pch • ParetoTI</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Find the smallest polytope (Principal Convex Hull) that contains most of the data — fit_pch" />

<meta property="og:description" content="fit_pch() fits a polytope (Principal Convex Hull) to data using PCHA algorithm. All of the listed functions take input matrix dim(variables/dimentions, examples) and return archetype positions (XC) of dim(variables/dimentions, archetypes).
k_fit_pch() finds polytopes of k dimensions in the data. This function applies fit_pch() to different k-s.
fit_pch_bootstrap() uses resampling data with or without replacement (bootstrapping) to find robust positions of archetypes of a polytope (Principal Convex Hull) describing the data. This function uses fit_pch_resample().
average_pch_fits() averages archetypes positions and relevant metrics across polytope fit obtained using bootstraping. Uses output of fit_pch_bootstrap() directly.
fit_pch_resample() takes one sample of the data and fits a polytope (Principal Convex Hull) to data. This function uses fit_pch().
randomise_fit_pch() helps answer the question &quot;how likely you are to observe data shaped as polytope given no relationship between variables?&quot; This function disrupts the relationships between variables, find a polytope that best describes the data. It calculates variance explained, t-ratio of polytope volume to convex hull volume. Optionally, it uses bootstrapping of data points to measure variance in archetype positions. This function uses randomise_fit_pch1(). Number of archetypes is determined automatically from arc_data.
randomise_fit_pch1() disrupts the relationships between variables (one sampling iteration), keeping the distribution of each variable constant, and fits a polytope (Principal Convex Hull) to data. This function uses rand_var and fit_pch().
fit_convhulln() computes smallest convex hull that encloses a set of points using convhulln and returns positions of convex hull points (positions = TRUE).
merge_arch_dist() calculates distance to archtypes, and merges distance matrix to data that was used to identify archetypes, optionally adds other features of data points (through colData).
plot.r_pch_fit() plot distribution of t-ratio, total variance in archetype positions and variance explained used to calculate empirical p-value
plot_dim_var() plot distribution of variance in archetype positions in each dimension and corresponding empirical p-values
pch_fit() a constructor function for the &quot;pch_fit&quot; class
subset.k_pch_fit() subsetting method for k_pch_fit object, allows selecting specific number of archetypes from k_fit_pch function output. E.g. useful to do PCA and UMAP projection for selected number of archetypes to aviod recalculation." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ParetoTI</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Comparison_to_kmeans.html">Comparison of achetypal analysis and k-means clustering</a>
    </li>
    <li>
      <a href="../articles/Hepatocyte_example.html">Example of using archetypal analysis to find representative cells &amp; describe heterogeniety in hepatocyte population between those archetypes</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the smallest polytope (Principal Convex Hull) that contains most of the data</h1>
    
    <div class="hidden name"><code>fit_pch.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>fit_pch()</code> fits a polytope (Principal Convex Hull) to data using PCHA algorithm. All of the listed functions take input matrix dim(variables/dimentions, examples) and return archetype positions (XC) of dim(variables/dimentions, archetypes).</p>
<p><code>k_fit_pch()</code> finds polytopes of k dimensions in the data. This function applies <code>fit_pch()</code> to different k-s.</p>
<p><code>fit_pch_bootstrap()</code> uses resampling data with or without replacement (bootstrapping) to find robust positions of archetypes of a polytope (Principal Convex Hull) describing the data. This function uses <code>fit_pch_resample()</code>.</p>
<p><code>average_pch_fits()</code> averages archetypes positions and relevant metrics across polytope fit obtained using bootstraping. Uses output of fit_pch_bootstrap() directly.</p>
<p><code>fit_pch_resample()</code> takes one sample of the data and fits a polytope (Principal Convex Hull) to data. This function uses <code>fit_pch()</code>.</p>
<p><code>randomise_fit_pch()</code> helps answer the question "how likely you are to observe data shaped as polytope given no relationship between variables?" This function disrupts the relationships between variables, find a polytope that best describes the data. It calculates variance explained, t-ratio of polytope volume to convex hull volume. Optionally, it uses bootstrapping of data points to measure variance in archetype positions. This function uses <code>randomise_fit_pch1()</code>. Number of archetypes is determined automatically from <code>arc_data</code>.</p>
<p><code>randomise_fit_pch1()</code> disrupts the relationships between variables (one sampling iteration), keeping the distribution of each variable constant, and fits a polytope (Principal Convex Hull) to data. This function uses <code><a href='rand_var.html'>rand_var</a></code> and <code>fit_pch()</code>.</p>
<p><code>fit_convhulln()</code> computes smallest convex hull that encloses a set of points using <code><a href='https://www.rdocumentation.org/packages/geometry/topics/convhulln'>convhulln</a></code> and returns positions of convex hull points (positions = TRUE).</p>
<p><code>merge_arch_dist()</code> calculates distance to archtypes, and merges distance matrix to data that was used to identify archetypes, optionally adds other features of data points (through colData).</p>
<p>plot.r_pch_fit() plot distribution of t-ratio, total variance in archetype positions and variance explained used to calculate empirical p-value</p>
<p>plot_dim_var() plot distribution of variance in archetype positions in each dimension and corresponding empirical p-values</p>
<p><code>pch_fit()</code> a constructor function for the "pch_fit" class</p>
<p><code>subset.k_pch_fit()</code> subsetting method for k_pch_fit object, allows selecting specific number of archetypes from k_fit_pch function output. E.g. useful to do PCA and UMAP projection for selected number of archetypes to aviod recalculation.</p>
    
    </div>

    <pre class="usage"><span class='fu'>fit_pch</span>(<span class='no'>data</span>, <span class='kw'>noc</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>), <span class='kw'>I</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>U</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>delta</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>conv_crit</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>, <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>check_installed</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>order_by</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>data</span>)),
  <span class='kw'>order_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"align"</span>, <span class='st'>"cosine"</span>, <span class='st'>"side"</span>),
  <span class='kw'>volume_ratio</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"t_ratio"</span>, <span class='st'>"variance_ratio"</span>, <span class='st'>"none"</span>),
  <span class='kw'>converge_else_fail</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>var_in_dims</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"pcha"</span>, <span class='st'>"kmeans"</span>),
  <span class='kw'>method_options</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>())

<span class='fu'>k_fit_pch</span>(<span class='no'>data</span>, <span class='kw'>ks</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='kw'>check_installed</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>bootstrap</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>bootstrap_N</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='fl'>0.65</span>, <span class='kw'>bootstrap_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"s"</span>, <span class='st'>"m"</span>,
  <span class='st'>"cmq"</span>)[<span class='fl'>1</span>], <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>345</span>, <span class='kw'>simplex</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>var_in_dims</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>fit_pch_bootstrap</span>(<span class='no'>data</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>check_installed</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"s"</span>, <span class='st'>"m"</span>, <span class='st'>"cmq"</span>)[<span class='fl'>1</span>],
  <span class='kw'>clust_options</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>235</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>average</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>order_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"cosine"</span>, <span class='st'>"side"</span>, <span class='st'>"align"</span>)[<span class='fl'>3</span>],
  <span class='kw'>var_in_dims</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>reference</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='fu'>average_pch_fits</span>(<span class='no'>res</span>, <span class='kw'>XC_array</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>fit_pch_resample</span>(<span class='kw'>i</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>data</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>var_in_dims</span> <span class='kw'>=</span> <span class='no'>var_in_dims</span>, <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='no'>normalise_var</span>, <span class='no'>...</span>)

<span class='fu'>randomise_fit_pch</span>(<span class='no'>data</span>, <span class='no'>arc_data</span>, <span class='kw'>n_rand</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>bootstrap_N</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>NA</span>, <span class='fl'>50</span>)[<span class='fl'>1</span>], <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>435</span>, <span class='kw'>volume_ratio</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"t_ratio"</span>,
  <span class='st'>"variance_ratio"</span>, <span class='st'>"none"</span>)[<span class='fl'>1</span>], <span class='kw'>maxiter</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>delta</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>order_type</span> <span class='kw'>=</span> <span class='st'>"align"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"s"</span>, <span class='st'>"m"</span>, <span class='st'>"cmq"</span>)[<span class='fl'>1</span>],
  <span class='kw'>clust_options</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>check_installed</span> <span class='kw'>=</span> <span class='no'>T</span>,
  <span class='no'>...</span>)

<span class='fu'>randomise_fit_pch1</span>(<span class='kw'>i</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>data</span>, <span class='kw'>ks</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>prob</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>bootstrap_N</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>435</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='fl'>0.65</span>,
  <span class='kw'>bootstrap_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"s"</span>, <span class='st'>"m"</span>, <span class='st'>"cmq"</span>)[<span class='fl'>1</span>], <span class='kw'>return_data</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>return_arc</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>bootstrap_average</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>volume_ratio</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"t_ratio"</span>, <span class='st'>"variance_ratio"</span>, <span class='st'>"none"</span>)[<span class='fl'>1</span>],
  <span class='kw'>var_in_dims</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>normalise_var</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>fit_convhulln</span>(<span class='no'>data</span>, <span class='kw'>positions</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>merge_arch_dist</span>(<span class='no'>arc_data</span>, <span class='no'>data</span>, <span class='no'>feature_data</span>, <span class='kw'>colData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>colData_id</span>,
  <span class='kw'>dist_metric</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"euclidean"</span>, <span class='st'>"arch_weights"</span>)[<span class='fl'>1</span>], <span class='kw'>rank</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># S3 method for pch_fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>res</span>)

<span class='co'># S3 method for k_pch_fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>res</span>)

<span class='co'># S3 method for b_pch_fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>res</span>)

<span class='co'># S3 method for r_pch_fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='no'>res</span>)

<span class='co'># S3 method for r_pch_fit</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>rand_arch</span>, <span class='kw'>ks</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unique'>unique</a></span>(<span class='no'>rand_arch</span>$<span class='no'>rand_dist</span>$<span class='no'>k</span>),
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"total_var"</span>, <span class='st'>"varexpl"</span>, <span class='st'>"t_ratio"</span>), <span class='kw'>colors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"#1F77B4"</span>,
  <span class='st'>"#D62728"</span>, <span class='st'>"#2CA02C"</span>, <span class='st'>"#17BED0"</span>, <span class='st'>"#006400"</span>, <span class='st'>"#FF7E0F"</span>), <span class='kw'>nudge_y</span> <span class='kw'>=</span> <span class='fl'>0.8</span>,
  <span class='kw'>nudge_x</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>text_lab_size</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>line_size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='fu'>plot_dim_var</span>(<span class='no'>rand_arch</span>, <span class='kw'>ks</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unique'>unique</a></span>(<span class='no'>rand_arch</span>$<span class='no'>rand_dist</span>$<span class='no'>k</span>),
  <span class='kw'>dim_names</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"V1"</span>, <span class='st'>"V2"</span>, <span class='st'>"V3"</span>, <span class='st'>"V4"</span>, <span class='st'>"V5"</span>, <span class='st'>"V6"</span>),
  <span class='kw'>colors</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"#1F77B4"</span>, <span class='st'>"#D62728"</span>, <span class='st'>"#2CA02C"</span>, <span class='st'>"#17BED0"</span>, <span class='st'>"#006400"</span>,
  <span class='st'>"#FF7E0F"</span>), <span class='kw'>nudge_y</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>nudge_x</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>text_lab_size</span> <span class='kw'>=</span> <span class='fl'>4</span>,
  <span class='kw'>line_size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='fu'>pch_fit</span>(<span class='no'>XC</span>, <span class='no'>S</span>, <span class='no'>C</span>, <span class='no'>SSE</span>, <span class='no'>varexpl</span>, <span class='no'>arc_vol</span>, <span class='no'>hull_vol</span>, <span class='no'>t_ratio</span>, <span class='no'>var_vert</span>,
  <span class='no'>var_dim</span>, <span class='no'>total_var</span>, <span class='no'>summary</span>, <span class='no'>call</span>)

<span class='fu'>subset.k_pch_fit</span>(<span class='no'>arc_data</span>, <span class='no'>ks</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>numeric matrix or object coercible to matrix in which to find archetypes, dim(variables/dimentions, examples)</p></td>
    </tr>
    <tr>
      <th>noc</th>
      <td><p>integer, number of archetypes to find</p></td>
    </tr>
    <tr>
      <th>I</th>
      <td><p>vector, entries of data to use for dictionary in C (optional)</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>vector, entries of data to model in S (optional)</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>parameter that inflates original polytope(simplex) fit such that it may contain more points of the dataset</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if TRUE display messages</p></td>
    </tr>
    <tr>
      <th>conv_crit</th>
      <td><p>The convergence criteria (default: 10^-4 relative change in SSE). Reduce to 1e-3 for reduced computation time but more approximate results. Increase to 1e-6 for improved accuracy (python and Matlab default). 1e-4 gives very similar results to 1e-5 or 1e-6 on datasets I looked at.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>maximum number of iterations (default: 500 iterations)</p></td>
    </tr>
    <tr>
      <th>check_installed</th>
      <td><p>if TRUE, check if python module py_pcha is found. Useful to set to FALSE for running analysis or within other functions</p></td>
    </tr>
    <tr>
      <th>order_by</th>
      <td><p>integer, dimensions to be used for ordering archetypes. Archetypes are ordered by angle (cosine) between c(1, 1) vector and a vector pointing to that archetype. Additional step finds when archetype vector is to the left (counter-clockwise) of the c(1, 1) vector. When bootstraping archetypes can be aligned to reference and ordered (order_type == "align") by these dimensions.</p></td>
    </tr>
    <tr>
      <th>order_type</th>
      <td><p>order archetypes by: cosine distance from c(1,1, ..., 1) vector ("cosine"), dot product that measures position to each side of the c(1,1) vector ("side"), align positions to reference when bootstraping(fit using all data, "align"). See <a href='align_arc.html'>align_arc</a> When order_type is "align" archetypes are ordered by "cosine" first.</p></td>
    </tr>
    <tr>
      <th>volume_ratio</th>
      <td><p>find volume of the convex hull of the data and the t-ratio ("t_ratio") or ratio of variance of archetype positions to variance of data ("variance_ratio") or do nothing ("none")? Caution! Geometric figure should be at least simplex: qhull algorhirm will fail to find convex hull of flat 2D shapes in 3D, 3D shapes in 4D and so on. So, for calculating this dimentions are selected based order of rows in data. Makes sense for principal components but not for original data. Caution 2! Computation time and memory use increse very quickly with dimensions. Do not use for more than 7-8 dimentions.</p></td>
    </tr>
    <tr>
      <th>converge_else_fail</th>
      <td><p>throw an error and stop execution if PCHA did not converge in <code>maxiter</code> steps.</p></td>
    </tr>
    <tr>
      <th>var_in_dims</th>
      <td><p>calculate variance in dimensions across archetypes in addition to variance in archetypes.</p></td>
    </tr>
    <tr>
      <th>normalise_var</th>
      <td><p>normalise variance in position of archetypes by variance in data in each dimention</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method for archetypal analysis: PCHA (default), <a href='https://www.rdocumentation.org/packages/stats/topics/kmeans'>kmeans</a>. Non-default methods use <code>data</code> and <code>noc</code>for data matrix and the number of archetypes, pass additional arguments via method_options.</p></td>
    </tr>
    <tr>
      <th>method_options</th>
      <td><p>additional arguments for non-default method, named list: <code><a href='https://www.rdocumentation.org/packages/base/topics/list'>list(arg = "value")</a></code>.</p></td>
    </tr>
    <tr>
      <th>ks</th>
      <td><p>integer vector, dimensions of polytopes to be fit to data</p></td>
    </tr>
    <tr>
      <th>bootstrap</th>
      <td><p><code>k_fit_pch()</code>: use bootstrap to find average positions for each k? Also returns variability in archetype position to aid the selection of k. At excessive k position vary more.</p></td>
    </tr>
    <tr>
      <th>bootstrap_N</th>
      <td><p>randomise_fit_pch1() and k_fit_pch(): integer, number of bootstrap samples on random data to measure variability in archetype positions. Set to NA fit once to all data instead of bootstraping. When this option is positive seed bootstrap_seed and sample_prop must be provided.</p></td>
    </tr>
    <tr>
      <th>sample_prop</th>
      <td><p>either NULL or the proportion of dataset that should be included in each sample. If NULL the polytope fitting algorithm is run n times on the same data which is useful for evaluating how often the algorithm gets stuck in local optima.</p></td>
    </tr>
    <tr>
      <th>bootstrap_type</th>
      <td><p><code>randomise_fit_pch1()</code> and <code>k_fit_pch()</code>: parallel processing type when bootstraping. Caution: avoid nested parallel processing, do not use "m" and "cmq" inside other parallel functions.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>seed for reproducible random number generation. Works for all types of processing.</p></td>
    </tr>
    <tr>
      <th>simplex</th>
      <td><p>when testing multiple k using <code>k_fit_pch()</code> match dimensions to the number of archetypes? Use only on ordered principal components. If FALSE try all k for all dimensions in data. If simplex == TRUE test only simplex shapes (k=3 in 2D, k=4 in 3D, k=5 in 4D...). This assumes order of columns which is valid for principal components but may not be valid for untransformed data.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of samples to be taken when bootstraping</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>one of s, m, cmq. s means single core processing using lapply. m means multi-core parallel procession using parLapply. cmq means multi-node parallel processing on a computing cluster using clustermq package. "See also" for details.</p></td>
    </tr>
    <tr>
      <th>clust_options</th>
      <td><p>list of options for parallel processing. The default for "m" is list(cores = parallel::detectCores()-1, cluster_type = "PSOCK"). The default for "cmq" is list(memory = 2000, template = list(), n_jobs = 10, fail_on_error = FALSE). Change these options as required.</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>should resampling be with replacement? passed to <a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample.int</a></p></td>
    </tr>
    <tr>
      <th>average</th>
      <td><p>average archetype positions and varexpl? By default FALSE, return all fits to resampled data.</p></td>
    </tr>
    <tr>
      <th>reference</th>
      <td><p>align archetypes (order_type="align") against reference polytope based on all data (TRUE), or align to the polytope from the first bootstrap iteration (FALSE). Second option can save time for large datasets</p></td>
    </tr>
    <tr>
      <th>XC_array</th>
      <td><p>Used by average_pch_fits() inside fit_pch_bootstrap(). You should not to use it in most cases.</p></td>
    </tr>
    <tr>
      <th>i</th>
      <td><p>iteration number</p></td>
    </tr>
    <tr>
      <th>arc_data</th>
      <td><p>observed polytope that describes the data. Class pch_fit, b_pch_fit and k_pch_fit objects generated by <code>fit_pch()</code> or <code>fit_pch_bootstrap()</code></p></td>
    </tr>
    <tr>
      <th>n_rand</th>
      <td><p>number of randomisation samples</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>a vector of probability weights for obtaining the elements of the vector being sampled. Passed to <code>(sample.int</code>.</p></td>
    </tr>
    <tr>
      <th>return_data</th>
      <td><p>return randomised data?</p></td>
    </tr>
    <tr>
      <th>return_arc</th>
      <td><p>return archetype positions in randomised data?</p></td>
    </tr>
    <tr>
      <th>bootstrap_average</th>
      <td><p><code>randomise_fit_pch1()</code>: average positions and summary statistics when bootstraping? Passed to <code>average</code> argument of <code>fit_pch_bootstrap()</code>. When multiple ks this defaults to TRUE.</p></td>
    </tr>
    <tr>
      <th>positions</th>
      <td><p>return positions of convex hull points?</p></td>
    </tr>
    <tr>
      <th>feature_data</th>
      <td><p>matrix with dim(dimensions, examples) where rownames are feature names and colnames are sample_id.</p></td>
    </tr>
    <tr>
      <th>colData</th>
      <td><p>annotations of examples in feature_data - dim(examples, dimensions), e.g. colData in SingleCellExperiment object or output of <a href='find_set_activity_AUCell.html'>find_set_activity_AUCell</a>.</p></td>
    </tr>
    <tr>
      <th>colData_id</th>
      <td><p>column in colData that contains values matching colnames of feature_data.</p></td>
    </tr>
    <tr>
      <th>dist_metric</th>
      <td><p>how to describe distance to archetypes. Currently euclidean distance and archetype weights are implemented. Archetypes weights come from <code>arc_data$S</code> matrix so bootstrapped archetype positions cannot be used - only single fit to all data.</p></td>
    </tr>
    <tr>
      <th>rank</th>
      <td><p>rank by distance metric (euclidean distance)?</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>fit_pch_resample/fit_pch_bootstrap: TRUE and FALSE are passed to <code><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample.int</a></code> for density-based sampling, "geo_sketch" tells to sample examples using geosketch method preserving geometry of the data. See <a href='geo_sketch.html'>geo_sketch</a>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>fit_pch()</code>: object of class pch_fit (list) containing the following elements:
XC - numeric matrix, dim(I, noc)/dim(dimensions, archetypes) feature matrix (i.e. XC=data[,I]*C forming the archetypes), or matrix with cluster centers (method = "kmeans");
S - numeric matrix of archetype values per example (e.g. cell) or cluster membership (method = "kmeans"), dim(noc, length(U)) matrix, S&gt;=0 |S_j|_1=1;
C - numeric matrix, dim(noc, length(U)) matrix, S&gt;=0 |S_j|_1=1;
SSE - numeric vector (1L), Sum of Squared Errors;
varexpl - numeric vector (1L), Percent variation explained by the model.
hull_vol - numeric vector (1L), Volume of convex hull of the data.
arc_vol - numeric vector (1L), Volume of polytope enclosed by archetypes.
t_ratio - numeric vector (1L), Ratio of <code>arc_vol</code> to <code>hull_vol</code>
var_vert - numeric vector (noc L), Variance in position of each archetype.
var_dim - numeric vector (noc L), Variance in positions of archetypes in each dimension.
total_var - numeric vector (1L), Mean variance in position of all archetypes.
summary - data.table with varexpl, t_ratio, total_var and noc for ease of combining multiple shape fits.
call - function call.</p>
<p><code>k_fit_pch()</code>: object of class k_pch_fit (list) containing the same elements as pch_fit, but each is either a list of pch_fit elements (e.g. list of ks number of XC matrices) or a vector (which pch_fit element is one number). When length(ks) = 1 returns pch_fit.</p>
<p><code>fit_pch_bootstrap()</code> object of class b_pch_fit (list) containing the same elements as pch_fit, but each is either a list of pch_fit elements (e.g. list of n number of XC matrices) or a vector (which pch_fit element is one number).</p>
<p><code>average_pch_fits()</code> object of class pch_fit</p>
<p><code>fit_pch_resample()</code> object of class pch_fit</p>
<p><code>randomise_fit_pch()</code> S3 "r_pch_fit" object (list) containing: 1. data table with columns variance explained (rand_varexpl), t-ratio (rand_t_ratio), variance in positions of archetypes (total_var) and number of archetypes (k) for <code>n_rand</code> samples; 2. empirical p-value for those parameters for each number of archetypes.</p>
<p><code>randomise_fit_pch1()</code>: list containing function call, summary of the sample, optional data and optional position of archetypes.</p>
<p><code>fit_convhulln()</code> list with 3 elements: hull - matrix storing positions of points dim(points, dimensions)); area - surface area for 3D or higher and perimeter for 2D; vol - volume for 3D and surface area for 2D.</p>
<p><code>merge_arch_dist()</code> list: data.table with samples in rows (speficied by sample_id column) and features in columns (including distance to archetypes); and character vectors listing names of archetypes, feature columns and colData columns.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>fit_pch()</code> provides an R interface to python implementation of PCHA algorithm (Principal Convex Hull Analysis) by Ulf Aslak (https://github.com/ulfaslak/py_pcha) which was originally developed for Archetypal Analysis by Mørup et. al.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://www.rdocumentation.org/packages/parallel/topics/clusterApply'>parLapply</a></code>, <code><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>lapply</a></code>, <code><a href='https://www.rdocumentation.org/packages/clustermq/topics/Q'>Q</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>4355</span>)
<span class='no'>archetypes</span> <span class='kw'>=</span> <span class='fu'><a href='generate_arc.html'>generate_arc</a></span>(<span class='kw'>arc_coord</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>5</span>, <span class='fl'>0</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>10</span>, <span class='fl'>15</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>30</span>, -<span class='fl'>20</span>)),
                          <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>N_dim</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; <span class='error'>Error in generate_arc(arc_coord = list(c(5, 0), c(-10, 15), c(-30, -20)),     mean = 0, sd = 1, N_dim = 2): unused argument (N_dim = 2)</span></div><div class='input'><span class='no'>data</span> <span class='kw'>=</span> <span class='fu'><a href='generate_arc.html'>generate_data</a></span>(<span class='no'>archetypes</span>, <span class='kw'>N_examples</span> <span class='kw'>=</span> <span class='fl'>1e4</span>, <span class='kw'>jiiter</span> <span class='kw'>=</span> <span class='fl'>0.04</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.9</span>)</div><div class='output co'>#&gt; <span class='error'>Error in ncol(archetypes): object 'archetypes' not found</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/dim'>dim</a></span>(<span class='no'>data</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='co'># Find 3 archetypes in this data</span>
<span class='no'>arc</span> <span class='kw'>=</span> <span class='fu'>fit_pch</span>(<span class='no'>data</span>, <span class='kw'>noc</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>), <span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as.vector(x, mode): cannot coerce type 'environment' to vector of type 'any'</span></div><div class='input'><span class='co'># Fit the model 3 times without resampling to test convergence of the algorithm.</span>
<span class='no'>arc_rob</span> <span class='kw'>=</span> <span class='fu'>fit_pch_bootstrap</span>(<span class='no'>data</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                         <span class='kw'>noc</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>), <span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as.vector(x, mode): cannot coerce type 'environment' to vector of type 'any'</span></div><div class='input'><span class='co'># Fit 10 models to resampled datasets each time looking at 70% of examples.</span>
<span class='no'>arc_data</span> <span class='kw'>=</span> <span class='fu'>fit_pch_bootstrap</span>(<span class='no'>data</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
                         <span class='kw'>noc</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>), <span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as.vector(x, mode): cannot coerce type 'environment' to vector of type 'any'</span></div><div class='input'>
<span class='co'># Use local parallel processing to fit 10 models to resampled datasets each time looking at 70% of examples.</span>
<span class='no'>arc_data</span> <span class='kw'>=</span> <span class='fu'>fit_pch_bootstrap</span>(<span class='no'>data</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='fl'>0.7</span>,
                         <span class='kw'>noc</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>), <span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"m"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as.vector(x, mode): cannot coerce type 'environment' to vector of type 'any'</span></div><div class='input'>
<span class='co'># Fit models with 2-4 archetypes</span>
<span class='no'>arc_ks</span> <span class='kw'>=</span> <span class='fu'>k_fit_pch</span>(<span class='no'>data</span>, <span class='kw'>ks</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='kw'>check_installed</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; <span class='error'>Error in as.vector(x, mode): cannot coerce type 'environment' to vector of type 'any'</span></div><div class='input'>
<span class='co'># Evaluate how much archetypes vary in randomised data, (variable shuffled</span>
<span class='co'># without replacement)</span>
<span class='no'>rand3</span> <span class='kw'>=</span> <span class='fu'>randomise_fit_pch1</span>(<span class='kw'>i</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>data</span>, <span class='kw'>true_fit</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>replace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>bootstrap_N</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>2543</span>,
    <span class='kw'>return_data</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>return_arc</span> <span class='kw'>=</span> <span class='no'>T</span>, <span class='kw'>sample_prop</span> <span class='kw'>=</span> <span class='fl'>0.65</span>,
    <span class='kw'>order_type</span> <span class='kw'>=</span> <span class='st'>"align"</span>, <span class='kw'>noc</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='fl'>3</span>),
    <span class='kw'>delta</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>bootstrap_type</span> <span class='kw'>=</span> <span class='st'>"cmq"</span>)</div><div class='output co'>#&gt; <span class='error'>Error in apply(x, MARGIN = MARGIN, FUN = function(x_i, n) {    x_i[sample.int(n, n, replace = replace, prob = prob)]}, n): dim(X) must have a positive length</span></div><div class='input'><span class='no'>p</span> <span class='kw'>=</span> <span class='fu'><a href='plot_arc.html'>plot_arc</a></span>(<span class='no'>arc_data</span>, <span class='no'>data</span>, <span class='kw'>which_dimensions</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>line_size</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in is(arc_data, "pch_fit"): object 'arc_data' not found</span></div><div class='input'><span class='co'># plot shapes of observed data and randomised data side-by-side using cowplot</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>cowplot</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘cowplot’ was built under R version 3.5.2</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘ggplot2’ was built under R version 3.5.2</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘cowplot’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:ggplot2’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    ggsave</span></div><div class='input'><span class='co'># create compound plot</span>
<span class='no'>p_all</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/cowplot/topics/plot_grid'>plot_grid</a></span>(<span class='kw'>plotlist</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='no'>p</span> + <span class='fu'>theme</span>(<span class='kw'>legend.position</span> <span class='kw'>=</span> <span class='st'>"none"</span>),
                                  <span class='fu'><a href='plot_arc.html'>plot_arc</a></span>(<span class='no'>rand3</span>$<span class='no'>arc_data</span>, <span class='no'>rand3</span>$<span class='no'>data</span>,
                                    <span class='kw'>which_dimensions</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>line_size</span> <span class='kw'>=</span> <span class='fl'>1</span>) +
                                    <span class='fu'>theme</span>(<span class='kw'>legend.position</span> <span class='kw'>=</span> <span class='st'>"none"</span>)))</div><div class='output co'>#&gt; <span class='error'>Error in plot_grid(plotlist = list(p + theme(legend.position = "none"),     plot_arc(rand3$arc_data, rand3$data, which_dimensions = 1:2,         line_size = 1) + theme(legend.position = "none"))): object 'p' not found</span></div><div class='input'><span class='no'>legend</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/cowplot/topics/get_legend'>get_legend</a></span>(<span class='no'>p</span>)</div><div class='output co'>#&gt; <span class='error'>Error in methods::is(plot, "function"): object 'p' not found</span></div><div class='input'><span class='co'># add legend to plot</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/cowplot/topics/plot_grid'>plot_grid</a></span>(<span class='no'>p_all</span>, <span class='no'>legend</span>, <span class='kw'>rel_widths</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>3.2</span>, <span class='fl'>.6</span>))</div><div class='output co'>#&gt; <span class='error'>Error in plot_grid(p_all, legend, rel_widths = c(3.2, 0.6)): object 'p_all' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Vitalii Kleshchevnikov</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Vitalii Kleshchevnikov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

