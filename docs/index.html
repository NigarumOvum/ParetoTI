<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pareto Task Inference In R (based on ParTI) • ParetoTI</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Pareto Task Inference In R (based on ParTI)">
<meta property="og:description" content="This package allows you to perform Pareto Task Inference in R as described in
    Yuval Hart &amp; Uri Alon paper in Nature Methods (2015):
    Inferring biological tasks using Pareto analysis of high-dimensional data.
    This package realises polytope dimentionality and
    polytope position fitting using a python 2.7 implementation of PCHA algorithm. 
    PCHA algorithm was originally implemented in Matlab by Morten Mørup (http://www.mortenmorup.dk/MMhomepageUpdated_files/Page327.htm)
    and re-implemented in python by Ulf Aslak Jensen.    
    Statistical significance of this fit is determined using permutations of the dataset 
    that disrupt relationships between variables but keep the distribution of each variable constant (not implemented yet).
    CAUTION! Package is currently under development! It enables only polytope fitting, bootstrap and visualisations.
    Other analyses, in particular, statistical significance by disrupting relationships between variable, 
    models of feature enrichment at archetype and currently being developed.
    Alternative methods for polytope fitting will be considered such as SPAMS implemented in c++ and using R interface: https://www.stat.berkeley.edu/~yuansi.chen/demo/demo.html, https://arxiv.org/pdf/1405.6472.pdf, http://spams-devel.gforge.inria.fr/downloads.html">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ParetoTI</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/introduction.html">Manual for Pareto front and task inference, ParetoTI R package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="paretoti-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#paretoti-r-package" class="anchor"></a>ParetoTI R package</h2>
<div id="pareto-task-inference-in-r-based-on-parti" class="section level3">
<h3 class="hasAnchor">
<a href="#pareto-task-inference-in-r-based-on-parti" class="anchor"></a>Pareto Task Inference In R (based on ParTI)</h3>
<p>This package allows to find tasks that cells need to perform and trade-offs between them.</p>
<p>Caution: the package in currently in development and testing. If you want to use it please contact Vitalii Kleshchevnikov (vk7 at sanger.ac.uk)</p>
<p>Need to perform multiple objectives and natural selection put cells on a Pareto front, a narrow subspace of optimal performance. When cells move along this front they trade-off performance at those tasks. Pareto front in the performance space translates into simple shapes gene expression of cell population. By finding minimal simplex polytope (triangle in 2D, tetrahedron in 3D, 5-vertex polytope in 4D) that encloses most of the data you can indentify the cellular tasks. This relies on recent work by Uri Alon group that showed that Pareto front is equal to minimal polytope defined by specialist phenotypes (convex hull defined by archetypes) and developed a matlab package ParTI for performing this analysis.</p>
<p>See <a href="https://vitkl.github.io/ParetoTI/articles/introduction.html">Manual</a>.</p>
<p>ParTI matlab package is described in more detail in Yuval Hart &amp; Uri Alon paper in Nature Methods (2015): <a href="https://www.nature.com/articles/nmeth.3254">Inferring biological tasks using Pareto analysis of high-dimensional data.</a></p>
<p>This ParetoTI R package realises very similar procedure with a few differences.</p>
<p>Polytope dimentionality and polytope positions are found using a python 2.7 implementation of PCHA algorithm. This algorithm was originally implemented in <a href="http://www.mortenmorup.dk/MMhomepageUpdated_files/Page327.htm">Matlab by Morten Mørup</a> and re-implemented in python by Ulf Aslak Jensen.</p>
<p>As in original package, statistical significance of this fit is determined using permutations of the dataset that disrupt relationships between variables but keep the distribution of each variable constant. We implement bootstraping method to measure variability in vertex position. This adds additional selection criteria for best fit polytopes. Excessive number of vertices will lead to higher variance in positions.</p>
<p>Features, genes whose expression decreases with distance from each vertex are identified using Generalised Additive Models (cubic splines) that define a smooth function of gene expression as a function of distance from vertices. We define p-value as the probability that the first derivative of this function is below zero (function is decreasing).</p>
</div>
<div id="using-the-package" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-package" class="anchor"></a>Using the package</h3>
<p><strong>Installation</strong></p>
<p>You need to install development version of this package from github.com and install a python dependency (PCHA algorithm implementation). If you want to take advantage of high-performance computing cluster you need to do extra set up, please follow the instructions here: <a href="https://github.com/mschubert/clustermq" class="uri">https://github.com/mschubert/clustermq</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install ParetoTI package, this should also install reticulate package, if not - install manually.</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"vitkl/ParetoTI"</span>, <span class="dt">dependencies =</span> T)
<span class="co"># Load package</span>
<span class="kw">library</span>(ParetoTI)
<span class="co"># Install python dependency into conda python environment and install py_pcha module</span>
ParetoTI<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ParetoTI/topics/install_py_pcha">install_py_pcha</a></span>(<span class="dt">method =</span> <span class="st">"conda"</span>)
<span class="co"># If no conda manager installed on your machine, try this (uncomment):</span>
## ParetoTI::install_py_pcha(method = "virtualenv")
<span class="co"># If this fails, install python 2.7 Anaconda distribution, then use 'method = "conda"'.</span>
<span class="co"># Finally, check that py_pcha library is successfully installed and discoverable</span>
reticulate<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/reticulate/topics/py_discover_config">py_discover_config</a></span>(<span class="st">"py_pcha"</span>)</code></pre></div>
<p><strong>Example: Fitting polytope to random triangle-shaped data (finding Pareto front)</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ParetoTI)
<span class="kw">library</span>(ggplot2)

<span class="co"># Generate random data that fits into the triangle (3D)</span>
<span class="kw">set.seed</span>(<span class="dv">4355</span>)
archetypes =<span class="st"> </span><span class="kw"><a href="reference/generate_arc.html">generate_arc</a></span>(<span class="dt">arc_coord =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">30</span>, <span class="op">-</span><span class="dv">20</span>, <span class="op">-</span><span class="dv">5</span>)),
                          <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
data =<span class="st"> </span><span class="kw"><a href="reference/generate_arc.html">generate_data</a></span>(archetypes<span class="op">$</span>XC, <span class="dt">N_examples =</span> <span class="fl">1e4</span>, <span class="dt">jiiter =</span> <span class="fl">0.04</span>, <span class="dt">size =</span> <span class="fl">0.9</span>)

<span class="co"># Fit polytope to those data</span>
arc_data =<span class="st"> </span><span class="kw"><a href="reference/fit_pch.html">fit_pch</a></span>(data, <span class="dt">noc =</span> <span class="kw">as.integer</span>(<span class="dv">3</span>), <span class="dt">delta =</span> <span class="dv">0</span>)

<span class="co"># Show results as interactive 3D scatterplot using plotly</span>
<span class="kw"><a href="reference/plot_arc.html">plot_arc</a></span>(<span class="dt">arch_data =</span> arc_data, <span class="dt">data =</span> data,
         <span class="dt">which_dimensions =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)
<span class="co"># Plot static 2D scatterplot using ggplot2</span>
<span class="kw"><a href="reference/plot_arc.html">plot_arc</a></span>(<span class="dt">arch_data =</span> arc_data, <span class="dt">data =</span> data,
         <span class="dt">which_dimensions =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()
<span class="co"># Plot data as 2D density rather than scatterplot</span>
<span class="kw"><a href="reference/plot_arc.html">plot_arc</a></span>(<span class="dt">arch_data =</span> arc_data, <span class="dt">data =</span> data,
    <span class="dt">which_dimensions =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">geom =</span> ggplot2<span class="op">::</span>geom_bin2d) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</code></pre></div>
</div>
<div id="development-and-further-improvements" class="section level3">
<h3 class="hasAnchor">
<a href="#development-and-further-improvements" class="anchor"></a>Development and further improvements</h3>
<p>It is currently under development and enables polytope fitting, statistical significance test by permutation, evaluating variance in vertex position by bootstraping, feature enrichment at archetype using the first derivative of Generalised Additive Model, measuring gene set activities in each cell with subsequent enrichment at archetype.</p>
<p>Key improvement that can be made is an implementation of PCHA algorhitm in c++ and for sparse matrices. Alternative methods for polytope fitting will be considered such as SPAMS implemented in c++ used via R interface: <a href="https://www.stat.berkeley.edu/~yuansi.chen/demo/demo.html" class="uri">https://www.stat.berkeley.edu/~yuansi.chen/demo/demo.html</a>, <a href="https://arxiv.org/pdf/1405.6472.pdf" class="uri">https://arxiv.org/pdf/1405.6472.pdf</a>, <a href="http://spams-devel.gforge.inria.fr/downloads.html" class="uri">http://spams-devel.gforge.inria.fr/downloads.html</a></p>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/vitkl/ParetoTI/issues">https://​github.com/​vitkl/​ParetoTI/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>Apache License 2.0</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Vitalii Kleshchevnikov <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Vitalii Kleshchevnikov.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
